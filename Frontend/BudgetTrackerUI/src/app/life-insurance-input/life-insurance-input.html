<h2 mat-dialog-title>Nouvelle Saisie de Relevé</h2>

<mat-dialog-content>
    <div style="display: flex; justify-content: space-between; align-items: flex-end; margin: 10px 0 20px 0;">
        <div style="display: flex; gap: 20px;">
            <div style="display: flex; flex-direction: column; gap: 4px;">
                <label style="font-size: 0.85em; color: #666;">Contrat</label>
                <select [ngModel]="selectedAccountId()" (ngModelChange)="onAccountChange($event)" 
                        style="padding: 6px; border-radius: 4px; border: 1px solid #ccc;">
                    <option *ngFor="let acc of accounts()" [value]="acc.id">{{ acc.owner }} - {{ acc.name }}</option>
                </select>
            </div>
            <div style="display: flex; flex-direction: column; gap: 4px;">
                <label style="font-size: 0.85em; color: #666;">Date du relevé</label>
                <input type="date" [(ngModel)]="saisieDate" 
                       style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            </div>
        </div>

        <button mat-stroked-button color="primary" (click)="addLine()">
            <mat-icon>add</mat-icon> Ajouter un actif
        </button>
    </div>

    <ag-grid-angular 
        style="width: 100%; height: 350px;" 
        class="ag-theme-alpine" 
        [columnDefs]="columnDefs"
        [rowData]="rowData()" 
        [singleClickEdit]="true"
        (cellValueChanged)="onCellValueChanged($event)"> 
    </ag-grid-angular>

    <div style="text-align: right; margin-top: 20px; font-size: 1.3em; color: #2c3e50;">
        Total valorisation : <strong>{{ totalSaisie() | currency:'EUR' }}</strong>
    </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button mat-button (click)="dialogRef.close()">Annuler</button>
    <button mat-raised-button color="primary" [disabled]="rowData().length === 0" (click)="onSave()">
        Enregistrer le relevé
    </button>
</mat-dialog-actions>